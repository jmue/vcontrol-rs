language: rust

cache: cargo

rust:
  - stable
  - beta
  - nightly

install:
  - [ $TRAVIS_RUST_VERSION = stable ] && rustup component add clippy

script:
  - cargo test
  - [ $TRAVIS_RUST_VERSION = stable ] && cargo clippy

deploy:
  provider: script
  script:
    - cargo publish --token "${CRATES_IO_TOKEN}"
  on:
    tags: true
    all_branches: true
    condition: $TRAVIS_RUST_VERSION = stable

notifications:
  email:
    on_success: never
